<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Git Flow Keypoints</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">Jianzong</a></h1>
            <a class="extra" href="/">home</a>
            <a class="extra" href="/about">about</a>
          </div>

          <h2>Git Flow Keypoints</h2>
<p class="meta">09 May 2014</p>

<div class="post start_page">
<h3>A successful git flow</h3>

<p><img src="/assets/git-flow.png" alt="Git flow image"></p>

<h3>Main branches:</h3>

<p><em>Master and developer is what we always keep on gitlab.</em></p>

<h4>master</h4>

<ol>
<li>Head should always reflects a production-ready state.</li>
<li>Every commit is a new release by definition.</li>
<li>Commits must be tagged for easy future reference.</li>
<li>Could use git hook script to automatically build and roll-out to production server when commit on master happnes.<br></li>
</ol>

<h4>develop</h4>

<ol>
<li>Always reflects a state with the latest delivered development changes for the next release. (where nightly builds happen)</li>
<li>When reaches a steady point, merge it into master (by a release branch).</li>
</ol>

<h3>Supporting branches</h3>

<p><em>Should follow strict rules to merge from/into.</em></p>

<h4>Feature branches</h4>

<p>From: develop</p>

<p>Into: develop</p>

<p>Naming: anything except master, develop, release-x, or hotfix-x</p>

<ol>
<li>Will be merged back into develop or discarded.</li>
<li>Feature branches typically exist in developer repos only, not in origin (not in allinns case).</li>
<li>Example: Weixin/manage feature in our case.</li>
<li>Remember to use --no-ff to create merge message.</li>
</ol>

<p><em>usage</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git checkout develop
<span class="nv">$ </span>git merge --no-ff myfeature
<span class="nv">$ </span>git branch -d myfeature
<span class="nv">$ </span>git push origin develop
</code></pre></div>

<p><code>--no-ff</code>
no fast-forwarding. Create a merge commit even when the merge resolves as a fast-forward. This is the default behaviour when merging an annotated (and possibly signed) tag.</p>

<h4>Release branches</h4>

<p>From: develop</p>

<p>Into: develop and master</p>

<p>Naming: release-x</p>

<ol>
<li>Preparation of a new production release.</li>
<li>Branch a release when develop reflects the desired state fo the new release.</li>
<li>Allow last minute bug fixes, preparing meta-data(version number, build dates).</li>
<li>Large new features strictly prohibited.</li>
<li>At this moment assign a versioin number.</li>
</ol>

<p><em>Creating</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git checkout -b release-1.2 develop
<span class="nv">$ </span>./bump-version.sh 1.2
<span class="nv">$ </span>git commit -a -m <span class="s2">&quot;Bumped version number to 1.2&quot;</span>
</code></pre></div>

<p><em>release branch to master branch</em></p>

<div class="highlight"><pre><code class="bash">t checkout master
<span class="nv">$ </span>git merge --no-ff release-1.2
<span class="nv">$ </span>./bump-version.sh 1.2
<span class="nv">$ </span>git tag -a 1.2
</code></pre></div>

<p><em>release branch to develop branch</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git checkout develop
<span class="nv">$ </span>git merge --no-ff release-1.2
</code></pre></div>

<p><em>remove release branch</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git branch -d release-1.2
</code></pre></div>

<h4>Hotfix branches</h4>

<p>From: master</p>

<p>Into: develop and master</p>

<p>Naming: hotfix-x</p>

<ol>
<li>Like release branch but unplanned.</li>
<li>The essence is that work of team members (on the develop branch) can continue, while another person is preparing a quick production fix.</li>
<li>If a release branch currently exists, merge into release branch instead of develop.</li>
</ol>

<p><em>branching</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git checkout -b hotfix-1.2.1 master
<span class="nv">$ </span>./bump-version.sh 1.2
<span class="nv">$ </span>git commit -a -m <span class="s2">&quot;Bumped version number to 1.2.1&quot;</span>
<span class="nv">$ </span>git commit -m <span class="s2">&quot;Fixed severe production problem&quot;</span>
</code></pre></div>

<p><em>finishing</em></p>

<div class="highlight"><pre><code class="bash"><span class="nv">$ </span>git checkout master
<span class="nv">$ </span>git merge --no-ff hotfix-1.2.1
<span class="nv">$ </span>git tag -a 1.2.1
<span class="nv">$ </span>git checkout develop
<span class="nv">$ </span>git merge --no-ff hotfix-1.2.1
<span class="nv">$ </span>git branch -d hotfix-1.2.1
</code></pre></div>

<h3>Reference</h3>

<p><a href="http://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a></p>

</div>


         <div class="footer">
</div>

        </div>

    </body>
</html>
